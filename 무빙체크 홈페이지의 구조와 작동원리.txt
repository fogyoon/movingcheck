무빙체크 홈페이지의 구조와 작동원리

임대차 계약에서 임대인과 임차인간의 분쟁을 줄이기 위한 사진 비교 서비스
입주시 촬영한 사진을 임차인 퇴거 시 촬영한 사진과 비교하여 임대물의 파손 여부 확인


[사용자의 이용 흐름과 기능 설명]

1. 카카오 계정으로 로그인

2. 첫 로그인인 경우 이름, 전화전호, 이메일주소 입력. (login.php)
입력하지 않아도 되지만 입력한다면 이용에 편의성이 있음(계약서 입력 시 본인의 정보 자동 입력 등)
사용자의 개인 정보를 저장하기 때문에 '개인정보처리방침'과 '약관' 작성 기재하였음 (홈페이지 소유자가 확인후 필요하다면 내용 수정)

3. 임대물 등록 (properties_edit.php)
등록된 임대물이 없다면 새로 등록
기존 등록된 임대물이 있다면 리스트에서 선택
사용자가 직접 등록 - 주소 검색 기능이 있어 주소로 검색하여 직접 등록
관리자가 등록 - 관리자가 등록한 임대물의 경우 공유로 설정되어 있는 임대물을 사용자가 선택 가능(희망 사항, 적용되지 않음)

4. 임대차 계약 선택 또는 등록 (properties.php)
선택한 임대물에서 현재 진행 중인 계약이 없다면 새로 등록
종료된 이전 계약 확인 가능
현재 진행 중인 임대차 계약 선택
DB contracts table의 status로 진행상황 파악('empty','movein_photo','movein_landlord_signed','movein_tenant_signed','moveout_photo','moveout_landlord_signed','moveout_tenant_signed','in_repair','finished')

5. 임대차 계약 등록 (contracts_edit.php)
계약서 업로드 (계약서에서 계약내용을 확인 자동 입력되는 서비스는 계약서 형식이 일정하지 않고 AI 구독 비용이 발생하는 이유로 적용하지 않음)
사용자의 이 계약에서의 역할 선택 (임대인, 임차인, 중개사) - 선택에 따라 DB contracts table의 landlord_id, tenant_id, agent_id에 사용자의 user_id가 저장됨
임대인, 임차인, 중개사의 이름과 전화번호 입력 - 사용자의 이름, 전화번호가 등록되어 있다면, 역할 선택 시 해당 인적사항에 자동입력됨
계약 시작 종료일 입력
보증금 월세 입력

6. 계약 관리와 사진 (contracts.php, photo_list.php)
등록된 계약의 정보 확인 및 수정, 삭제 가능 (입주 사진 임차임 서명 받기 전까지만 수정 삭제 가능)
계약의 진행 상황 확인 가능
서명 진행 상황 확인 가능
서명자의 이름과 전화번호가 계약서 상의 것도 일치 하지 않는 경우 알림 기능

사진 등록이나 서명 받은 여부 등의 진행 상황에 따라 할수 있는 액션 버튼이 아래와 같이 자동으로 다르게 나타남 (DB contracts table의 status로 단계 확인)

a. 입주 사진 등록 이전(empty) - 사진 등록 버튼
b. 입주 사진 등록되었다면(movein_photo) - 퇴거 사진 확인 버튼 클릭하여 등록 사진 페이지(photo_list.php)로 가면,
    사진 등록 버튼과 서명 버튼(추가로 사진을 더 등록할 수 도 있고, 촬영이 모두 끝났다고 판단되면 임대인 서명 진행)
    사용자의 해당 계약에서 역할이 임대인인 경우 서명하기 버튼
    사용자의 해당 계약에서 역할이 임차인 또는 중개사인 경우 임대인 서명 요청 버튼
    참고) 서명의 단계 - 아래와 같이 임대인 서명 이후 임차인 서명을 받도록 단계적으로 설계
    입주 사진 임대인 서명 -> 입주 사진 임차인 서명 -> 퇴거사진 임대인 서명 -> 퇴거사진 임차인 서명
c. 입주 사진 임대인 서명이 완료되었다면(movein_landlord_signed) - 퇴거 사진 확인 버튼 클릭하여 등록 사진 페이지(photo_list.php)로 가면,
    사진 등록 버튼과 임차인 서명 버튼
    사용자의 해당 계약에서 역할이 임차인인 경우 서명하기 버튼
    사용자의 해당 계약에서 역할이 임대인 또는 중개사인 경우 임차인 서명 요청 버튼
    사진을 추가 등록 할 수 있지만, 추가 등록하면 임대인의 서명을 다시 받아야 함. movein_photo 단계로 회귀 (사진 등록 버튼 누르면 해당 경고 메세지 나타남)
d. 입주 사진 임차인 서명이 완료되면(movein_tenant_signed) - 퇴거 사진 확인 버튼 클릭하여 등록 사진 페이지(photo_list.php)로 가면,
    각각의 부위 사진에 "파손사진 등록" 버튼이 생김
    파손이 발견된 부위만 사진 촬영하면 됨
    촬영 시작을 누르면 입주 사진이 카메라에 오버랩되어 보이므로 비교하며 같은 구도로 촬영 가능
    해결하지 못한 것) 현재 촬영 가메라가 세로 사진은 촬영이 어려운 상황임
e. 파손 사진이 등록되면(moveout_photo) - 퇴거 사진 확인 버튼 클릭하여 등록 사진 페이지(photo_list.php)로 가면,
    임대인 서명 버튼이 생김
    임대인 서명 전에는 파손사진 추가 등록 수정이 가능함
f. 파손사진에 임대인이 서명하면(moveout_landlord_signed) - 퇴거 사진 확인 버튼 클릭하여 등록 사진 페이지(photo_list.php)로 가면,
    임차인 서명 버튼이 생김
    임대인 서명을 받은 경우에도 파손사진 추가 등록이 가능하지만, 그런경우 임대인 서명을 다시 받아야 함.
g. 파손사진에 임차인이 서명하면(moveout_tenant_signed) - 퇴거 사진 확인 버튼 클릭하여 등록 사진 페이지(photo_list.php)로 가면,
    더이상 사진 등록이나 수정은 불가. 종료와 수리업체 사진 전송 버튼
    종료를 누르면 해당 계약이 종료 처리됩니다. (finished)
    수입업체 사진 전송 버튼을 눌러 입주/퇴거 비교 사진 링크를 수입업체에게 카톡으로 전송할 수 있음. (in_repair)
h. 종료 처리되면, 계약 리스트에서 사라지지만, 종료된 계약 보기를 스위칭 하면 볼 수 있음. 종료된 계약은 사진 확인만 가능함.


7. 서명 받기
사용자가 중개사인 경우, 임대인과 임차인에게 사진확인 및 서명 페이지의 url을 복사해 발송할 수 있음. (보안을 위해 비밀번호도 같이 발송)
사용자가 임대인이나 임차인인 경우, 각자의 서명은 홈페이지에서 바로하게됨
서명 진행 상황은 계약 관리 페이지(contracts.php)에서 확인 가능
임대인의 서명은 임차인 서명이 있기 전이라면 다시 할 수 있습니다.
임차인 서명 전에 계약 내용이나 사진 수정이 있었다면, 임대인 서명을 다시 받아야하 함
모든 서명은 등록 사진 페이지(photo_list.php)에서 확인 가능

8. 관리 페이지
사용자 관리
로그 확인 (분쟁 발생에 대비 상용자의 대부분 행동을 로그로 기록합니다.)
그외 개발에 필요한 것들(홈페이지 제작이 완료되면 보안을 위해 삭제됩니다. 개발 관련된 것등은 터치 금지 요망. DB 초기화 됩니다. )

9. 문의하기
admin 관리자의 이메일 주소나, config.inc에 저장된 이메일 주소로 문의하기 발송
로그인 아이디, 현재 페이지 등의 정보도 같이 수집됨


[보안 확보를 위한 조치]
1. 계약서, 입주 퇴거 사진 등의 사진이 저장되는 폴더에 .htaccess 파일 적용으로 서버 내부에서 사진 파일 사용이외의 접근을 차단함.
2. 모든 입력 폼에 SQL 인젝션 방지 적용
3. 인가받지 않는 자의 서명 페이지 접근을 막기 위해 SecureKey 사용과 비밀번호 확인
4. 서명한 임대인 임차인의 이름 또는 전화번호가 계약서 상의 것과 일치하지 않는 경우 상용자에게 알려주기 
5. 문의하기 스펨을 막기 위해 몇가지 스팸 방지 CAPTCHA 적용


[ 해결해야 할 것 ]
1. 퇴거 사진 촬영 시 스트리임 카메라가 세로 사진이 적용되지 않음. 세로 사진과 같은 화각으로 비교 사진 찍는데 어려움이 있음. 해결 방법을 찾는 중
2. 첫페이지(index.php) 디자인 개선
3. 카카오 계정 로그인 등록이 시급. 많은 버그와 수정 사항 들이 있을 수 있으니 충분한 테스트가 필요합니다. 
https://developers.kakao.com/product/kakaoLogin


[ 홒페이지 의뢰자가 원하는 추가 기능 들 ] 
1. 관리자가 임대물 등록하고, 사용자가 그 등록된 임대물의 찾아서 사용. (임대물 도면 등, 자세한 정보 입력을 원함)
2. 무빙체크 이용자가 다른 사람을 초대하여, 해당 계약에서의 역할을 할당하게 하는 기능. (중개사가 변경되는 경우 대비)
상기 내용은 이번 홈페이지 제작에는 적용되지 않습니다. 하지만, 나중에 추가 개발에 도움이 되도록 DB 설계 시 고려하였음. 


[ 홈페이지 운영자가 숙지하고 있어야 할 것 들 ]
1. 호스팅 (2026-06-09 만기)
https://hosting.cafe24.com/
홈페이지 로그인 (realtor2013 / qlalf7137756 )
DB와 FTP ( realtor2013 / qlalf7137756! )

2. cafe24에서 도메인도 구입 (2027-06-10 만기)
movingcheck.kr
movingcheck.co.kr 

3. SSL 인증서 
홈페이지에서 사용자와 주고받는 데이터 암호화. 반드시 필요
cafe24에서 호스팅관리 -> SSL Basic 신청/관리 (1년에 한번 씩 연재해줘야 합니다.)

4. config.inc 파일에 홈페지 설정 내용이 있음
DB 접속 정보
테스트 환경을 위한 사용자 아이디 선택과 아이피 (TEST_LOGIN_ID, TEST_ALLOWED_IPS)
사진 저장 시 파일 사이즈 줄여주는 정도를 설정할 수 있습니다. 

5. 개인정보 보호 책임자 정보 입력
config.inc 파일에서 아래 내용 입려해야 합니다. 
// 개인정보 보호책임자 정보
define('PRIVACY_OFFICER_NAME', '홍길동');
define('PRIVACY_OFFICER_EMAIL', 'privacy@movingcheck.kr');
define('PRIVACY_OFFICER_PHONE', '02-0000-0000');

6. 관리자 로그인
admin@movingcheck.kr / monetcom

7. 카카오 로그인 - kakao developer에 등록
https://developers.kakao.com/product/kakaoLogin